<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0066)http://www.asmirvine.com/gettingStartedVS2019/index.htm#tutorial32 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Assembly Language for x86 Processors</title>

    <link href="./Assembly Language for x86 Processors_files/style1.css" rel="stylesheet" type="text/css">
    <style type="text/css">
        .style1
        {
            font-style: italic;
        }
        .style2
        {
            width: 615px;
        }
		.box {
			border:2px solid navy; 
			padding:5px;
		}
    </style>
</head>

<body>
<a name="top"></a>
<table width="550" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr valign="top">
    <td class="titleBar">Getting Started with MASM and Visual Studio 2019</td>
  </tr>
  <tr valign="top"> 
    <td> 
		<p>
      </p><div class="style1">Updated 6/28/2019</div>
      <p>     
		  This tutorial assumes that you are using either the 7th or 8th Edition of <i>Assembly Language
		  for x86 Processors</i>, and you are using Visual Studio 2019. We tested these pages with the Community Edition, and have 
		  every reason to assume the Enterprise Edition will work the same way.
		  </p><p>
		  <b>Here's how to get started:</b><br>
		  <a href="http://www.asmirvine.com/gettingStartedVS2019/Irvine.zip">Right-click here to download the code examples and required libraries for the book.</a> Unzip the downloaded file into a directory named Irvine on Drive C. Next, <a href="http://www.asmirvine.com/gettingStartedVS2019/Project32_VS2019.zip">Right-click here to download a zip file containing a 32-bit Visual Studio 2019 project</a>. You can extract this file into any folder on your computer. Finally, <a href="http://www.asmirvine.com/gettingStartedVS2019/Project64_VS2019.zip">Right-click here to download a zip file containing a 64-bit Visual Studio 2019 project</a>. You can extract this file into any folder on your computer. Now you are ready to begin the tutorials
		  listed below.		  
		  </p><p> 
      	Topics:
</p><ul>        
        <li><a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#tutorial32">Tutorial: Building and running a 32-bit program</a></li>
        <li><a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#tutorial64">Tutorial: Building and running a 64-bit program</a></li>
        <li><a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#16-bit">Building 16-bit programs</a></li>
        <li><a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#syntax">Syntax highlighting in your source code</a></li>
		<!--
	   <li><a href="#batch">Assembling, linking, and debugging with a batch file</a></li>
	   <li><a href="#CreatingProject">Creating a 32-Bit Project from Scratch</a></li>
	   -->
        <li><a href="http://www.asmirvine.com/debug/vstudio2019/index.htm">Using the Visual Studio debugger</a></li>
        <li><a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#BlockedPrograms">EXE Programs blocked by antivirus software</a></li>
</ul>
<p>
      Found an error in this document? Please <a href="mailto:kip@asmirvine.com?subject=Error%20in%20Getting%20Started%20document">email 
        the author</a>. 
            
<a name="Required"></a>
      
</p><h4>Required Setup for 32-bit Applications</h4>
	After you have downloaded and installed the VS 2019 Community Edition, you 
	may need to install the Visual C++ language option. First, let's see if it has
	already been installed (as often happens in college computer labs). Select File &gt;&gt; New &gt;&gt; Project from the Visual Studio menu. You will see this <i>Create a new project</i> dialog window. Look for C++ in the Language dropdown list: 
	<p>
	<img src="./Assembly Language for x86 Processors_files/p33.gif" height="175" border="1">
	</p><p>

	<i>Note: If you do not see Visual C++ in the list, close Visual Studio and run a separate program named the Visual Studio Installer. If your computer is in a college laboratory, your account may not have sufficient privileges to run this program, so you can ask your lab supervisor to do this. </i>
	</p><p>
	(If you run the VS installer, select the <i>Desktop development with C++</i> button in the installer window, look at the Summary list on the right side to verify that VC++ is selected, and click the Modify button in the lower right corner of the window.)
	</p><p>
	<img src="./Assembly Language for x86 Processors_files/32.gif" height="350">
	</p><p>
	The Visual C++ language includes the Microsoft Assembler (MASM). To verify that MASM is installed, open a Windows Explorer window and look for the file named <b>ml.exe</b> in the Visual Studio installation directory, such as 
	<i>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Tools\MSVC\14.xx.xxxx\bin\HostX64\x86</i>.
	(The "x" characters above indicate digits in the version number of your current VS installation.)
	

</p><h4>The Book's Example Programs</h4>
      
	At the top of this document, we explained how to download the file named Irvine.zip and extract it into
	the C:\Irvine folder. Unless you have some objection to using that 
        location, do not alter the path. (Note to lab administrators: you can designate c:\Irvine 
        directory as read-only.).<p></p>
      <p>The folllowing files should appear in the c:\Irvine directory:</p>
      <table width="95%" border="0" cellspacing="0" cellpadding="3">
        <tbody><tr> 
          <td width="16%"> 
            <b>Filename</b>
          </td>
          <td width="84%"> 
            <b>Description</b>
          </td>
        </tr>
        <tr> 
          <td width="16%"> 
            b16.asm, b32.asm
          </td>
          <td width="84%"> 
            Blank templates for 16-bit and 32-bit assembly language source files
          </td>
        </tr>
        <tr> 
          <td width="16%"> 
            GraphWin.inc
          </td>
          <td width="84%"> 
            Include file for writing Windows applications
          </td>
        </tr>
        <tr> 
          <td width="16%"> 
            Irvine16.inc
          </td>
          <td width="84%"> 
            Include file used with the Irvine16 link library (16-bit applications)          
          </td>
        </tr>
        <tr> 
          <td width="16%"> 
            Irvine16.lib
          </td>
          <td width="84%"> 
            16-bit link function library used with this book
          </td>
        </tr>
        <tr> 
          <td width="16%"> 
            Irvine32.inc
          </td>
          <td width="84%"> 
            Include file used with the Irvine32 link library (32-bit applications)         
          </td>
        </tr>
        <tr> 
          <td width="16%"> 
            Irvine32.lib
          </td>
          <td width="84%"> 
            Irvine's 32-bit link library
          </td>
        </tr>
        <tr> 
          <td width="16%"> 
            Kernel32.lib</td>
          <td width="84%"> 
            32-bit link library for Windows API</td>
        </tr>
        <tr> 
          <td width="16%">Link16.exe</td>
          <td width="84%">16-bit Microsoft linker</td>
        </tr>
        <tr> 
          <td width="16%"> 
            Macros.inc
          </td>
          <td width="84%"> 
            Irvine's macro include file (see Chapter 10) 
          </td>
        </tr>
        <tr> 
          <td width="16%">make16_vs2019.bat</td>
          <td width="84%">Visual Studio 2019 batch file for building 16-bit applications</td>
        </tr>
        <tr> 
          <td width="16%"> 
            SmallWin.inc
          </td>
          <td width="84%"> 
            Small-sized include file containing MS-Windows definitions, used by Irvine32.inc
          </td>
        </tr>
        <tr> 
          <td width="16%">User32.lib</td>
          <td width="84%">MS-Windows basic I/O link library</td>
        </tr>
        <tr> 
          <td width="16%"> 
            VirtualKeys.inc
          </td>
          <td width="84%"> 
            Keyboard code definitions file, used by Irvine32.inc
          </td>
        </tr>
      </tbody></table>
      <p>A subdirectory named<b> Examples</b> will contain all the example programs shown 
		 in the book, source code for the book's 16-, 32-, and 64-bit 
		 libraries, and two sample projects for earlier versions of Visual Studio. </p>

<h3>Setting up Visual Studio</h3>

<h4>Select the C++ Configuration</h4>
		  Visual Studio supports multiple programming 
		  languages and application types. The C++ programming language configuration most closely
		  matches that of assembly language programming, so we suggest the following steps:
		  <ol>
			<li>Select <i>Tools &gt;&gt; Import and Export Settings</i> from the menu</li>
			<li>Select the "Import selected environment settings" radio button</li>
			<li>Select the "No, just import..." radio button</li>
			<li>Select "Visual C++" from the Default Settings List and click the Next button</li>
			<li>Click the Finish button, then click the Close button</li>
			<li>Notice the tabs on the left and right sides of the Visual Studio workspace. Close the Server Explorer, Toolbox, and Properties tabs. (Optionally, you can use the mouse to drag the Solution Explorer tool window to the right side of the workspace.)
			If you should accidentally close the Solution Explorer window in the future, you can bring it back: select View from the menu, and locate Solution Explorer in the list of views.
			</li>
		  </ol>
				
<h4>Optional Step: Set the tab indent size</h4>
	Start Visual Studio and select <b>Options</b> from the <b>Tools</b> 
    menu. Select and expand the <b>Text Editor</b> item, select <b>All Languages</b>, and select 
        <b>Tabs</b>. Optionally, you may want to select the <b>Insert spaces</b> radio button:<p></p>
      <p><img src="./Assembly Language for x86 Processors_files/p13.gif" style="height: 173px; width: 217px"></p>
      <p>I prefer to set the Tab Size and Indent Size values to 5.</p>

<!-- ***************************************************** -->
<a name="tutorial32"></a>
<h2>Tutorial: Building and running a 32-bit program</h2>
        Now you're ready to open and build your first 32-bit project.<h4>Opening a Project</h4>
      <p>Visual Studio requires assembly language source 
        files to belong to a <i>project</i>, which is a kind of container. A project 
        holds configuration information such as the locations of the assembler, 
        linker, and required libraries. A project has its own folder, and it holds 
        the names and locations of all files belonging to it. 
</p><p>		
	If you have not already done so,<a href="http://www.asmirvine.com/gettingStartedVS2019/Project32_VS2019.zip">Right-click here to download a zip file</a> containing an up-to-date Visual Studio 2019
	project that has been configured for assembly language. After downloading this file, un-zip it into your working directory.
	It contains a sample asm test file named AddTwo.asm.
	</p><p>		
      </p><p>Follow these steps:</p>
      <ol>		
        <li>Start Visual Studio. </li>
        <li>Open our sample Visual Studio project file by selecting <b>File/Open/Project</b> from the Visual Studio menu. </li>
        <li>Navigate to your working folder where you unzipped our project file, and 
            select the file named <b>Project.sln</b>.</li>
        <li>Once the project has been opened, you will see the project name in Visual Studio's <i>Solution Explorer</i> window. You should also
		    see an assembly language source file in the project named AddTwo.asm. Double-click the file name to open it in the editor.</li>
      </ol>
      <p>You should see the following program in the editor window:</p>
      <table width="60%" border="1" cellspacing="0" cellpadding="5">
        <tbody><tr valign="middle" align="left"> 
          <td> 
<pre>; AddTwo.asm - adds two 32-bit integers.
; Chapter 3 example

.386
.model flat,stdcall
.stack 4096
ExitProcess proto,dwExitCode:dword

.code
main proc
	mov	eax,5				
	add	eax,6				

	invoke ExitProcess,0
main endp
end main
</pre>
	 </td>
  </tr>
</tbody></table>
<p>
In the future, you can use this file as a starting point to create new programs
by copying it and renaming the copy in the Solution Explorer window. 
</p><p>
</p><div class="box">
<b>Adding a File to a Project:</b> If you need to add an .asm file to an open project, do the following: (1) Right-click the
project name in the Visual Studio window, select Add, select Existing Item. (2) In the <i>Add Existing Item</i> 
dialog window, browse to the location of the file you want to add, select the filename, and click
the Add button to close the dialog window.
</div>


<h4>Build the Program</h4>
<p>Now you will build (assemble and link) the sample program. Select <b>Build Project</b> from the 
	 Build menu. In the Output window for Visual Studio at the bottom of the screen, you should see messages 
  similar to the following, indicating the build progress:</p>
  
<div class="box">
<pre>1&gt;------ Build started: Project: Project, Configuration: Debug Win32 ------
1&gt;Assembling AddTwo.asm...
1&gt;Project.vcxproj -&gt; ...\Project32_VS2019\Debug\Project.exe
========== Build: 1 succeeded, 0 failed, 0 skipped ==========
</pre>
</div>

<p>If you do not see these messages, the project has probably not been modified since it was last built. No problem--just select <b>Rebuild Project</b> from the Build menu. </p>
		 
<h4>Run the Program in Debug Mode</h4>
    <p>The easiest way to run your first program is to use the debugger. First, you must set a breakpoint. When you set a breakpoint in a program, you can use the debugger to execute the program a full speed (more or less) until it reaches the breakpoint. 
        At that point, the debugger drops into single-step mode. Here's how to do it:
      </p><ol style="line-height:1.7em">
		<li>Make sure the ASM source code file is open in the editor window.</li>
        <li>Click the mouse along the border to the left of the <b>mov eax,5</b> 
          statement. A large red dot should appear in the margin.</li>
        <li>Select <em>Start Debugging</em> from the Debug menu. The program should run and pause on the line with the breakpoint. (Optionally, you can close the Diagnostic Tools, Autos, and Call Stack windows.)</li>
        <li>Press the F10 key (called <i>Step Over</i>) to execute the current 
          statement. Continue pressing F10 until the program is about to execute 
          the <b>invoke</b> statement. </li>
        <li>A small black window icon should appear on either your Windows desktop or status bar. The window should be blank because this program does not display any output.</li>
        <li>Press F10 one more time to end the program.</li>

	  </ol>
      <p>You can remove a breakpoint by clicking its dot with the mouse. Take 
        a few minutes to experiment with the Debug menu commands. Set more breakpoints 
        and run the program again.
		</p><p>
		Here's what your program will look like when paused at the breakpoint:<br>

      </p><p><img src="./Assembly Language for x86 Processors_files/p9.gif" style="height: 350px"></p>

<p>
</p><div class="box">
  <strong>Running a program from the Command Prompt:</strong> When you assembled 
	and linked the project, a file named Project.exe
	was created inside the project's \Debug folder. This file 
	  executes when you run the project. You can execute any EXE 
	  by double-clicking its name inside Windows Explorer, but it will often 
	  just flash on the screen and disappear. That is because Windows 
	  Explorer does not pause the display before closing the command window. 
	  On the other hand, you can open a Command prompt window, move to the 
	  Debug directory, and run Project.exe by typing "Project" 
	  (without the quotes). You will need to do some reading on Windows 
	  shell commands if you plan to use the command line.
</div>
<p>
        To remove a source file from the Visual Studio window, right-click its filename and 
		select <b>Remove</b>. The file will not be deleted from the file system. On the other 
		hand, if you want to delete the file, select it and press the Del key.

</p><h3>Registers</h3>
      <p>Soon you will want to display CPU registers when debugging your
	  programs. Here's how to make them visible: 
	  First, under the Tools &gt;&gt; Options menu, select Debbuging in the left panel,
	  and select <i>Enable address-level debugging</i>. Next, 
	  set a breakpoint in your source code on an executable statement, run your program in Debug mode, select <i>Windows</i> from the <i>Debug</i> menu, and then select 
        <i>Registers</i> from the drop-down list. 
		
		</p><div class="box">
		If you do not see the Registers command in the Debug &gt;&gt; Windows drop-down menu (which seems to be the case for the VS2019 Community Edition, there is a way to add a Registers command button to your Debug toolbar. Here's how to do it: <br>
		<ol>
			<li>While not debugging, select <i>Customize</i> from the Tools menu. </li>
			<li>Click the <i>Commands</i> tab, select the Toolbar tab, and select
			<i>Debug</i> from the list of toolbars.</li>
			<li>Click the <i>Add Command</i> button. In the <i>Categories</i> list, select <i>Debug</i>.</li>
			<li>Select <i>Registers</i> from the list of commands, click the OK button to close the dialog window.</li>
			<li>Click the <i>Close</i> button to close the Customize dialog. You should now
			see a new button on the Debug toolbar that looks like a small rectangle containing "0X" when you begin debugging a program.</li>
		</ol>
		</div>
		<p>
		The Registers window may appear docked to the top of the workspace, but you 
		may find it helpful to float the window on top of your workspace. Just grab
		the window header with the mouse and pull it to the center area. You will also
		want to display the CPU flags. To do that, right click inside the Registers window and check the word <i>Flags</i> from the popup menu. 
</p><p>
      You can interrupt a debugging session at any time by selecting <i>Stop 
        Debugging</i> from the Debug menu. You can do the same by clicking the 
        maroon-colored square button on the toolbar. To remove a breakpoint from a program, click its red dot to make it disappear.
		</p><p>
		A reminder, you might want to review our tutorial:
		<a href="http://www.asmirvine.com/debug/vstudio2019/index.htm">Using the Visual Studio debugger</a>
		
</p><h4>Building and Running Other Programs</h4>
      <p>Suppose you want to run another example program, or possibly create your 
        own program. You can remove the existing assembly language file from the Solution Explorer window and insert a new .asm file into the project.</p>
      <ul>
        <li>To remove a program from a project without deleting the file, right-click 
          its name in the <i>Solution Explorer window</i>. In the context menu, 
          select <b>Remove</b>. If you change your mind and decide 
          to add it back to the project, right-click in the same window, select 
          <b>Add,</b> select <b>Existing item,</b> and select the file you want 
          to add.</li>
      </ul>
		
<h4>Adding a File to a Project</h4>
      <p>An easy way to add an assembly language source file to an open project 
        is to drag its filename with the mouse from a Windows Explorer window 
        onto the name of your project in the Solution Explorer window. The  
		  physical file will not be copied--the project only holds a reference to the
		  file's location. 
        Try this now: </p>
      <ol>
        <li>Remove the AddTwo.asm file from your project. </li>
        <li>Add a reference to the file Examples\ch03\AddTwoSum.asm to 
          the project. </li>
        <li>Build and run the project. </li>
      </ol>
		
<h4>Copying a Source File</h4>
      <p>One way to make a copy of an existing source code file is to use Windows Explorer 
        to copy the file into your project directory. Then, right-click the project 
        name in Solution Explorer, select Add, select Existing Item, and select 
        the filename.</p>
      <p></p>
      <p><a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#top">Return to top</a></p>
      
      <hr>
      <hr>
      <hr>
      <hr>
      <hr>
      <hr>

<!-- ******************************************************************** -->
 		
<a name="tutorial64"></a>
<p>
</p><h2>Tutorial: Building and running a 64-bit program</h2>
In this tutorial, we will show you how to assemble, link, and run a sample 64-bit program. We assume 
you have already completed our tutorial entitled <i>Building a 32-Bit Assembly Language Program</i>.

	<p>Do the following steps, in order:</p>
      <ol>	
		<li><a href="http://www.asmirvine.com/gettingStartedVS2019/Project64_VS2019.zip">Right-click here to download the Project64_VS2019.zip file</a> and unzip it into your working directory.</li>
        <li>In Visual Studio 2019, select Open Project from the File menu, navigate to the Project64_VS2019 folder, and select the file named <b>Project.sln</b>.</li>
		 <li>You are about to add an existing source code file to the project. To 
			 do that, right-click on <b>Project</b> in the Solution Explorer window, select <b>Add</b>,&nbsp; select <b>Existing 
			 Item</b>, navigate to the book's Examples\ch03\64 bit" folder, select <b>AddTwoSum_64.asm</b>, and click the <b>Add</b> button to close the dialog window. </li>
		 <li>Open the AddTwoSum_64.asm file for editing by double-clicking its filename in the Solution Explorer window.</li>
      </ol>

      <p>You should see the following program in the editor window:</p>
<pre>; AddTwoSum_64.asm - Chapter 3 example.

ExitProcess proto

.data
sum qword 0

.code
main proc
   mov  rax,5
   add  rax,6
   mov  sum,rax

   mov  ecx,0
   call ExitProcess

main endp
end
</pre>
<i>(Notice that the program's entry point is the main procedure. If you wish to use a different name for your startup
procedure in your own programs, you can modify this option by selecting Properties from the Project menu, and then selecting Linker / Advanced / Entry Point.)</i>

<h4>Build the Program</h4>
Select <b>Build Project</b> from the Build menu. You should see text written to Visual Studio's output window like the following:

<pre>1&gt;------ Build started: Project: Project, Configuration: Debug x64 ------
1&gt;  Assembling AddTwoSum_64.asm...
1&gt;  Project64_VS2019.vcxproj -&gt; ...\Project64_VS2019\x64\Debug\Project.exe
========== Build: 1 succeeded, 0 failed, 0 up-to-date, 0 skipped ==========
</pre>

If you do not see these messages, the project has probably not been modified 
  since it was last built. No problem--just select <b>Rebuild Project</b> from the 
 Build menu.
<p>
You use the same Visual Studio commands to run and debug 64-bit programs as you would for 32-bit programs.
		
</p><p></p>
<p><a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#top">Return to top</a></p>



<hr>
<hr>
<hr>
<hr>
<hr>
<hr>
 
 <!-- ******************************************************************** -->
 <!-- ******************************************************************** -->
  
<a name="16-bit">
<p>
</p><h2>Building 16-bit programs (Chapters 14-17)</h2>
      <p>Only Chapters 14 through 17 require you to build 16-bit applications. 
        Except for a few exceptions, which are noted in the book, your 16-bit 
        applications will run under the 32-bit versions of Windows (Windows XP, Windows Vista, Windows 7).
	</p>

</a><div style="border:1px solid blue; padding:10px 10px 10px 10px"><a name="16-bit">
  	If you're interested in running 16-bit programs under 64-bit Windows, you 
		will need to enable a feature named NTVDM.) 
		</a><a href="https://www.groovypost.com/howto/enable-16-bit-application-support-windows-10/" target="_blank">Click here to read a web site with instructions on how to do this.</a> Another
		alternative you may wish to explore	is to install a virtual machine (using a free program named <a href="https://www.virtualbox.org/">VirtualBox</a> from Oracle) and install 32-bit Windows on the virtual machine.
<p>
		The book's example programs in Chapters 1-13 have been successfully 
			tested in 32-bit Windows 7,8, and 10. On the other hand, many programs in Chapters 14-17 will not run in any Microsoft OS later than Windows 98, because they rely on direct access to hardware and system memory.
		 You cannot directly run 16-bit applications in any 64-bit version of Windows.
</p></div>
	 
      <p>If you plan to build 16-bit applications, you need to add two new commands 
        to the Visual Studio Tools menu. To add a command, 
        select <b>External Tools</b> from the Tools menu. The following dialog 
        will appear, although many of the items in your list on the left side 
        will be missing. Download the batch file here (rename the .txt extension to .bat after downloading): <a href="http://www.asmirvine.com/gettingStartedVS2019/make16_vs2019.txt">make16_vs2019.txt</a>.
</p>
      <p><img src="./Assembly Language for x86 Processors_files/p14.gif" alt="" width="396" height="398"></p>
      <p>&nbsp;</p>
		
<h3>Step 1: Create the Build 16-bit ASM Command</h3>
      <p>Click the <b>Add</b> button and fill in the Title, Command, Arguments, 
        and Initial directory fields as shown in the screen snapshot. If you click 
        the buttons with arrows on the right side of the Arguments and Initial 
        directory fields, a convenient list appears. You can select an item without 
        having to worry about spelling:</p>
      <p><img src="./Assembly Language for x86 Processors_files/p15.gif" width="144" height="357"></p>
      <p>Click the <b>Apply</b> button to save the command.</p>
      <p>&nbsp;</p>
		
<h3>Step 2: Create the Run 16-bit ASM Command</h3>
	  <p>Click the Add button again, and create a new command named <b>Run 16-bit 
        ASM</b>: </p>
      <p><img src="./Assembly Language for x86 Processors_files/p16.gif" width="396" height="398"></p>
      <p>Uncheck the "Close on exit" option and click the OK button to save the command and close the External Tools 
        dialog. </p>
      
<h4>Testing Your new 16-Bit Commands</h4>
      <p>To test your new 16-bit commands, close any Visual Studio project that happens to be open. Then, select File | Open | File from the menu and choose the file named <b>16-bit.asm</b> 
        from the ch03 folder in the book's example programs. Select <b>Build 16-bit 
        ASM </b>from the Tools menu. The following command window should appear, 
        showing the successful execution of the assembler and linker, followed 
        by a listing of all files related to this program:</p>
      <p><img src="./Assembly Language for x86 Processors_files/p17.gif" width="637" height="283"></p>
      <p>Press a key to close the window. Next, you will run the program. Select 
        <b>Run 16-bit ASM</b> from the Tools menu. The following window will appear, 
        although the contents of all registers except EAX will be different:</p>
      <p><img src="./Assembly Language for x86 Processors_files/p18.gif" width="533" height="163"></p>
      <p>Press a key to close the window.</p>
      <p>You have completed the setup for building and running 16-bit assembly 
        language programs.</p>
      <p><a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#top">Return to top</a></p>
      
      <a name="CreatingProject"></a>
<hr>

<!--
<h2>Creating a 32-Bit Project From Scratch</h2>
    Visual Studio makes it possible (in 14 steps!) to create an Assembly Language project from scratch. 
	You must create a Win32 Console application designed for C++ and modify various settings.</p>
    
    <p>
Step 1: Select New from the File menu, then select Project. In the New Project window, select 
<strong>Win32</strong> under Visual C++ in the left panel, and select <strong>Win32 Console 
Application</strong> in the middle panel. Give your project a suitable name (near the bottom 
of the window):</p>
        <p>
            <img alt="" src="p28.gif" style="height: 355px; width: 739px" /></p>
        <p>(Depending on your Visual Studio configuration, you might have to find Visual C++ 
		under the &quot;Other Languages&quot; category in the left panel.)</p>
        <p>
Step 2: Click the <strong>OK</strong> button to continue. The Win32 Application Wizard window 
will appear. Select <strong>Application Settings</strong>, and then select the 
<strong>Empty project</strong> check box. </p>
        <p>
            <img alt="" src="29.gif" style="height: 445px; width: 578px" /></p>
		  <p />
Step 3:
        Click the <strong>Finish</strong> button to save the new project.
		  <p />
Step 4:
        Open the Solution Explorer window and add an assembly language source file to your project. Here's how:
		Right-click the project name in the Visual Studio window, select Add, select Existing Item. 
		In the <i>Add Existing Item</i> dialog window, browse to the location of the file you want to 
		add, select the filename, and click the Add button to close the dialog window.
		<p />
		<i>Note: You may delete the Header Files, Resource Files, and Source Files folders if you wish. 
		They are not necessary.</i>
		<p />
Step 5:
		Next, right click your project name, select <strong>Build Dependencies</strong>, then select 
		<strong>Build Customizations</strong> from the 
		popup menu. When you see this window, select the check box next to <strong>masm</strong> 
		and click the OK button to close the dialog.
        <p />
            <img alt="" src="30.gif" height="300" />
		<p />
Step 6: You're almost ready to set the assembler properties. But first, you must help Visual 
		Studio associate source code files having the .asm extension with the Microsoft Macro Assembler. To do this,		
		right-click the .asm file in the Solution Explorer window, select Properties from
		the popup window, click on <i>Item Type</i> in the right-hand pane, scroll down the list, and select
		<i>Microsoft Macro Assembler</i>. Click OK to close the dialog window.
	  <p />
Step 7: 
		Right-click the project name in the Solution Explorer window and select Properties from 
		the popup menu. Expand the entry under <b>Configuration Properties</b>. 
        Then expand the entry named <b>Microsoft Macro Assembler</b>. This 
        is what you should see:</p>
      <p><img src="p3.gif" height="400"/></p>
      <p />
Step 8:
		Modify the <b>Include Paths</b> option so it equals "C:\Irvine". This tells the 
		assembler where to find files having a filename extension of &quot;.inc&quot;. 
		Here is a sample:</p>
      <p><img src="p4.gif" width="749" height="521"/></p>
Step 9:
	  Next, select the <b>Listing File</b> entry, also in the Microsoft Macro Assembler group. 
	  Modify the Assembled Code Listing File entry (shown below) so it contains 
	  <strong>$(ProjectName).lst.</strong> This uses a built-in variable to identify 
	  the name of the source input file, with a file extension of .lst. So, if your 
	  project were named MyProject, the listing file would be named MyProject.lst:	  
	  <p><img src="p23.gif" width="749" height="521"/></p>
	  
      <p />
Step 10: Find the Linker entry under <b>Configuration Properties</b>. Select the 
        <b>Input</b> entry in the left panel and insert <strong>irvine32.lib;</strong> at the beginning of the 
        <b>Additional Dependencies</b> entry. The <b>irvine32.lib</b> file is the link library 
		file supplied with this book. The filenames must be separated by semicolons.</p>
      <p />
          <img alt="" src="p5.gif" style="width: 753px" />
      <p />
	  <p />
Step 11: Select <b>Linker</b> under Configuration Properties, and then select 
        <b>General</b>. The <b>Additional Library Directories</b> entry must contain 
		<b>c:\Irvine</b> so the linker can find the Irvine32.lib library file:</p>
      <p>
          <img alt="" src="p11.gif" style="height: 544px; width: 752px" /></p>
<p>
Step 12: Select <b>Linker </b>under the <b>Configuration Properties</b> and select 
        <b>Debugging</b>. Verify that the <b>Generate Debug</b> <b>Info</b> option 
          is equal to <b>Yes(/DEBUG)</b></p>
      <p><img src="p6.gif" width="749" height="521" /></p>
      <p>
Step 13: Select <strong>Advanced</strong> under the <strong>Linker</strong> entry. Set the <em>
          Image Has Safe Exception Handlers</em> option to <strong>No</strong>.</p>
        <p>
            <img alt="" src="p25.gif" style="height: 536px; width: 746px" /></p>
        <p/>
Step 14:
	Click the OK button to close the Property Pages window. Verify that your project 
	has been created correctly by building and debugging the program as you did in an 
	earlier tutorial.
      <p/>  
		<a href="#top">Return to top</a><br />
      </p>
      <p>&nbsp;</p>
      <p>&nbsp;</p>
      <p>&nbsp; </p>
      <hr>

<h3><a name="Listing"></a>Generating a Source Listing File</h3>
      Open the project. From the menu, select <b>Project</b>, select <b> 
        Properties</b>. In the list box, select <b>Microsoft Macro Assembler</b>, 
        then select <b>Listing File</b>. Set the <b>Assembled Code Listing file</b> 
        option to <b>$(InputName).lst</b>.
      <p />
      <a href="#top">Return to top</a>
      <p />
      <p />
      <p />
      <hr />
      <h2><a name="Scratch"></a></h2>
-->      
	  <hr>
	  
      <h3><a name="syntax"></a>Syntax highlighting in your source code</h3>
	  
      <p>When a text editor uses syntax highlighting, language keywords, strings, 
        and other elements appear in different colors. Visual Studio highlights MASM 
          reserved words and strings, as shown in the following example:</p>
      <p><img src="./Assembly Language for x86 Processors_files/p26.gif" style="height: 506px; width: 742px"></p>
	  
      <p>This won't happen automatically, but you can create a syntax definition 
        file named Usertype.dat that contains MASM keywords. Then when Visual 
        Studio starts, it reads the syntax file and highlights 
        MASM keywords. </p>
						
      <p>
	  If you decide to use Visual Studio's built-in MASM syntax highlighter, here are the required steps to set it up:
      </p><p>
	  1) Download this <a href="http://www.asmirvine.com/gettingStartedVS2019/usertype.zip">Usertype.dat</a> file (enclosed in a ZIP file)
        given here to a folder in which you have read/write permissions. Extract it from the 
		zip archive. 		
      </p><p>
	  2) Close Visual Studio.
	  </p><p>
	  3) Copy Usertype.dat to the 
		C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\Common7\IDE
		folder.
          </p><p>         
          Windows will display 
        a confirmation dialog before copying the file.
	  </p><p>
	  4) Open Visual Studio, select <b>Options</b> from 
        the Tools menu, select <b>Text Editor</b>, and select <b>File Extension</b>. 
        On the right side of the dialog (shown below), enter <b>asm</b> as the 
        extension, select <b>Microsoft Visual C++</b> from the Editor list, and 
        click the <b>Add</b> button. Click the <b>OK</b> button to save your changes.</p>
      <p><img src="./Assembly Language for x86 Processors_files/p21.gif" width="644" height="382"></p>
      <p>
		Open your project and display an ASM file. You should see syntax highlighting in the editor. There is a 
		glitch in the highlighting--assembly language comment line starts start with a 
		semicolon, which C++ doesn't recognize. But this is a simple workaround: add
		an extra // right after the semicolon, like this, which will cause the comments to
		appear in their usual green color:
		</p><pre>;// AddTwo.asm - adds two 32-bit integers.
;// Chapter 3 example
		</pre>  
      <a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#top">Return to top</a><br>
      <p></p>
      <hr>
<!--	  
      <h2><a name="batch"></a>Assembling, Linking, and Debugging a 32-bit Program with a Batch File</h2>
        <p>Many people like to use a <i>Windows batch file</i> to assemble and link 
        programs. A batch file is a text file containing a sequence of commands 
        that execute as if they had been typed at the command prompt. In fact, 
        they are powerful enough to contain variables, loops, IF statements, and 
        so on. </p>
      <p>The easiest way to run a batch file is to first open a Command window 
        and then type the name of the batch file (along with arguments) at the 
        command prompt. To open a Command window, you must execute a program named 
        <b>cmd.exe</b>. We will make that easy for you. </p>
        <b>Step 1: </b><a href="BatchSampleVS2013.zip">Download a ZIP file</a> containing the following items:</p>
        <ul>
            <li><b>A shortcut to cmd.exe,</b> which opens a Command window in the current 
                directory</li>
        <li><b>asm32.bat</b>, a batch file for assembling and linking programs</li>
        <li><b>main.asm</b>, a sample assembly language program</li>
      </ul>
		<b>Step 2:</b> Extract the ZIP file into the c:\Irvine\Examples directory on 
		your computer.
		<p />
		<b>Step 3: </b>If you're running 64-bit Windows, open the file with a text 
		editor (such as NotePad++) and find this line:
		  <pre>
		  set VS_HOME=C:\Program Files\Microsoft Visual Studio 12.0 
		  </pre>
		  And change it to the correct path for Visual Studio:
		  <pre>
		  set VS_HOME=C:\Program Files (x86)\Microsoft Visual Studio 12.0 
		  </pre>		  

		  <b>Step 4: </b>Do the following:
      <ul>
        <li>Copy asm32.bat to any directory on your system path. By doing this, you 
		make it possible for MS-Windows to recognize <b>asm32</b> as a valid command 
		when typed at the MS-Windows command prompt.(If you want to find out which 
		directories are on the current system path, type <b>path</b> and press Enter 
		at the system command prompt.)</li>
        <li>Double-click the shortcut to <b>cmd.exe</b>. A Command window should 
          appear. </li>
        <li>At the command prompt in this window, type <b>asm32</b> and press Enter. This
		will execute the asm32 batch file and display help information.
        </li>
      </ul>

<table width="70%" border="1" cellspacing="0" cellpadding="3">
   <tr valign="top"> 
     <td class="style2"> 
<pre>
This file assembles, links, and debugs a single assembly language
source file. Before using it, install Visual Studio 2013 in the following
directory: 

    C:\Program Files\Microsoft Visual Studio 12.0


Next, install the Irvine link libraires and include
files in the following directory: C:\Irvine


Finally, copy this batch file to a location on your system path.
We recommend the following directory: 


C:\Program Files\Microsoft Visual Studio 12.0\VC\bin


Command-line syntax:

  asm32 [/H | /h | -H | -h] -- display this help information

  asm32 filelist -- assemble and link all files
  asm32 /D filelist -- assemble, link, and debug
  asm32 /C filelist -- assemble only

&lt;filelist&gt; is a list of up to 5 filenames (without extensions),
separated by spaces. The filenames are assumed to refer to files
having .asm extensions. Command-line switches are case-sensitive.
</pre>

    </td>
  </tr>
</table>
      <p>Type the following command to assemble and link a source file named <b>main.asm</b>:</p>
      <pre>    asm32 main</pre>
      <p>You should see the following messages: </p>
      <table width="80%" border="1" cellspacing="0" cellpadding="12">
        <tr> 
          <td> 
            <pre> Assembling: main.asm</pre>
            <pre>The file main.obj was produced.
..................................</pre>
            <pre>Linking main.obj to the Irvine32, Kernel32, and User32 libraries.</pre>
            <pre>The file main.exe was produced.
..................................</pre>
          </td>
        </tr>
      </table>
      <p>In fact, several files were produced. </p>
      <ul>
        <li>main.obj - the object file</li>
        <li>main.ilk - incremental link status file</li>
        <li>main.pdb - debug symbol file</li>
      </ul>
	    <p>If there were syntax errors in your program, you would see error messages generated 
        by the assembler. Here is an example:</p>
      <pre> Assembling: main.asm<br>main.asm(9) : error A2008: syntax error : myMessage<br>main.asm(15) : error A2006: undefined symbol : myMessage
</pre>
      <p>You would then open the main.asm file with a text editor (such as Notepad), 
        fix the errors, and run the asm32 batch file again.</p>
      <table width="90%" border="1" cellspacing="0" cellpadding="15">
        <tr> 
          <td>Although we used a file named main.asm in this example, the asm32.bat 
            batch file will work for any assembly language file, regardless of 
            the name. The only requirement is that your assembly language source 
            file have a <b>.asm</b> filename extension. </td>
        </tr>
      </table>
      <h4>Assembling Programs in Other Directories</h4>
      <p>No doubt, you will want to assemble programs in various different disk 
        folders, not just the batch_sample folder used in the foregoing example. 
        All you need to do is copy the <b>cmd.exe</b> shortcut we gave you to 
        your working directory, where your assembly language source files are 
        located. When you double-click to run the shortcut, it will open a Command 
        window in the current folder.</p>
      <h4>Assembling, Linking, and Debugging<br>
      </h4>
      <p> </p>
      <p>In addition to assembling and linking, you can use the asm32.bat file 
        to launch your program in the Visual Studio debugger. Try the following 
        command:</p>
      <pre>    asm32 /D main</pre>
      <p></p>
      <p>If the program assembles and links with no errors, your program should 
        load in Visual Studio. The first time you do this with a new program, 
        the source code will not appear. All you have to do is press the <b>F10 
        key</b> to begin debugging, and your program should appear with a yellow 
        band across the first executable line:</p>
      <p><img src="p24.gif" width="729" height="574"></p>
      <p>(Depending on how Visual Studio is configured, you might have to press 
        F8 to do the same thing.)</p>
      <p>From here, you can step through the program. When you get to the call 
        to WriteString, you can even trace into its code by pressing the F11 key 
        (trace to). When you finish, close Visual Studio.</p>
      <p>From this time on, when you load the same program in the Visual Studio 
        debugger, your source code will appear right away.</p>
      <h4>Assembling without Linking</h4>
      <p>Occasionally, you may want to assemble programs but not link them. This 
        happens, for example, when you are creating a multimodule project and 
        you want to assemble each asm file into an obj file separately before 
        linking them into the final exe program. Or, you might be assembling a 
        module to be inserted into a link library (like Irvine32.lib).</p>
      <p>To assemble a source file only, inser the /C option before the name of 
        the file being assembled: </p>
      <pre>    asm32 /C main</pre>
      <p>You should see the following output:</p>
      <pre> Assembling: main.asm</pre>
      <pre>The file main.obj was produced.
..................................
</pre>
      <p>If you are interested in learning more about how batch file commands 
        work, here are some reference links we found:</p>
      <ul>
        <li>Microsoft TechNet article: 
            <a href="http://technet.microsoft.com/en-us/library/cc750054.aspx">Creating 
          Truly Powerful Batch Files</a>, by Brien Posey </li>
        <li>Microsoft TechNet article: 
            <a href="http://technet.microsoft.com/en-us/library/cc750056.aspx">Using 
          Batch Files in Windows NT</a>, by Troy Thompson</li>
      </ul>
      <p>Links go out of date quickly, but you can do a web search for <i>Windows batch 
        files</i> and get plenty of hits.</p>
      <p />
        <a href="#top">Return to top</a><br />
    </td>
  </tr>
</table>

******************** end of hidden section ******************-->


<!-- ***************************************************** -->
<a name="BlockedPrograms"></a>
<div style="width:80%">
<h2>Was your program's EXE file blocked by an Antivirus scanner?</h2>
Antivirus scanner software has improved greatly in recent years, and so have the number of viruses (one website reports 50,000 at present). Because of this, your computer's antivirus scanner may report a false positive when you build your program, and refuse to let you run it. There are a few workarounds: (1) You can add your project's bin/debug folder into an exclusion list in your antivirus configuration. This is my
preferred approach, and it nearly always works. (2) You can suspend your realtime antivirus scanner software, but this will leave you open to malware for a short time. If you choose this option, be sure to temporarily disconnect your computer from the Internet. 
<p>
<a href="http://www.asmirvine.com/gettingStartedVS2019/index.htm#top">Return to top</a>
</p></div>


	<a name="Windows7"></a>
	<hr>
	<h3>&nbsp;</h3>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	<p>
		&nbsp;</p>
	
	<p>
		&nbsp;</p>
		
<div style="display:none">		
      <table width="95%" border="1" cellspacing="0" cellpadding="3">
        <tbody><tr valign="top"> 
          <td> 
            <p><i><b>Tip:</b></i> If the <i>Solution Explorer</i> window is not 
              visible, select <i>Solution Explorer </i>from the <i>View</i> menu. 
              Also, if you do not see <i>main.asm</i> in the Solution Explorer 
              window, it might be hidden behind another window. To bring it to the front, click the
			  <i>Solution Explorer</i> tab from the tabs shown along the bottom of the window.</p>
          </td>
        </tr>
      </tbody></table>		
</div>		


		


</td></tr></tbody></table></body></html>